# V2 Mega-Refactor Plan

This document outlines the long-term vision for the V2 refactoring of the Anahata AI framework and the NetBeans plugin.

## Core Goals

The V2 plan is to split the `gemini-java-client` into a modular architecture to support multiple AI models and UI frameworks.

## Key Architectural Changes

-   **Active Workspace Model:** Transition from storing file state in the conversation history to an "Active Workspace" model. In this model, a central manager will hold the state of all files, and this state will be injected into the user prompt on each turn. This will eliminate the current context bloat where file-writing tools keep the content in the context twice (once in the `FunctionCall` and once in the `FunctionResponse`).

-   **Code Cleanup:** Remove obsolete singleton-based classes like `ContextFiles` which are incompatible with the planned multi-instance architecture.
